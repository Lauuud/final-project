{"files":[{"id":"dce52f84-e503-4af6-94b3-9bf3a7d34930","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Hong_Kong\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"acb3784a-3c8e-46fa-8089-29b080769419","name":"Code","type":"server_js","source":"function main(){\n\n  // 定义参数\n  var fromfileID \u003d \u00271-ZWfSoZ7hOx5e4jZCrI86I_XVf-3SG9JBjQa2FaVAlk\u0027;\n  var fromsheet \u003d \u0027今日情况\u0027;\n  var 今日入库column \u003d \"B1:B200\";\n  var 今日出库column \u003d \"C1:C200\";\n  var 今日净入库column \u003d \"D1:D200\";\n\n\n  var tofileID \u003d \"1lKIUJY4M2Rtkv3sf4sLv3SuXXaxbxsST3Itnb0RdDJg\";\n  var 入库sheet \u003d \"入库\";\n  var 出库sheet \u003d \"出库\";\n  var 净入库sheet \u003d \"净入库\";\n\n  //  执行 func\n  copycolumn(fromfileID, fromsheet, 今日入库column, tofileID, 入库sheet);\n  copycolumn(fromfileID, fromsheet, 今日出库column, tofileID, 出库sheet);\n  copycolumn(fromfileID, fromsheet, 今日净入库column, tofileID, 净入库sheet);\n\n\n  // 执行的是历史价格，先命名fromfile的sheet column\n  var 今日进货单价column \u003d \"E1:E200\";\n  var 今日水费column \u003d \"F1:F200\";\n  var 今日COGScolumn \u003d \"G1:G200\";\n  var 今日大陆售价column \u003d \"H1:H200\";\n  var 今日毛利润column \u003d \"I1:I200\";\n  var 今日仓库盈利column \u003d \"J1:J200\";\n\n  // 转移进货单价，水费，COGS，大陆售价等信息\n  var topricefile \u003d \"1Jlo_UCAFq8tjRsRlH5gTW693TixkfFruLpxKpBt64eE\";\n  var 进货单价sheet \u003d \"进货单价\";\n  var 水费sheet \u003d \"水费\";\n  var COGSsheet \u003d \"COGS\";\n  var 大陆售价sheet \u003d \"大陆售价\";\n  var 毛利润sheet \u003d \"毛利润\";\n  var 仓库盈利sheet \u003d \u0027仓库盈利\u0027;\n\n  // 执行 func\n  copycolumn(fromfileID, fromsheet, 今日进货单价column, topricefile, 进货单价sheet);\n  copycolumn(fromfileID, fromsheet, 今日水费column, topricefile, 水费sheet);\n  copycolumn(fromfileID, fromsheet, 今日COGScolumn, topricefile, COGSsheet);\n  copycolumn(fromfileID, fromsheet, 今日大陆售价column, topricefile, 大陆售价sheet);\n  copycolumn(fromfileID, fromsheet, 今日毛利润column, topricefile, 毛利润sheet);\n  copycolumn(fromfileID, fromsheet, 今日仓库盈利column, topricefile, 仓库盈利sheet);\n\n\n\n}\n\n\n\nfunction copycolumn(fromfileID, fromsheet, fromrange, tofileID, tosheet) {\n\n  //定义变量\n  var fromfile \u003d SpreadsheetApp.openById(fromfileID);\n  var fromsheet \u003d fromfile.getSheetByName(fromsheet);\n  var values \u003d fromsheet.getRange(fromrange).getValues();   // 复制 column的信息\n\n  var tofile \u003d SpreadsheetApp.openById(tofileID);\n  var tosheet \u003d tofile.getSheetByName(tosheet);\n\n  var today \u003d Utilities.formatDate(new Date(), \"GMT+8\", \"MM/dd/yyyy\");; //很重要，只有date，没有timestamp\n\n  // 将 tosheet append一个 column\n  tosheet.insertColumnAfter(tosheet.getMaxColumns());\n  // 复制 data到column中\n  tosheet.getRange(1, tosheet.getMaxColumns(),values.length,1).setValues(values);\n  // 命名最后一个column的header为今天的日期\n  tosheet.getRange(1, tosheet.getMaxColumns()).setValue(today);\n\n}\n\n\nfunction get_column_index(sheet, columname) {\n  var headers \u003d sheet.getRange(1,1,1,sheet.getLastColumn()).getValues()[0]\n  \n  for (let i\u003d0; i\u003cheaders.length; i++) {\n    if (headers[i] \u003d\u003d columname) {\n      return i;\n    }\n    \n  }\n}\n\n\n"}]}